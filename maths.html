<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Maths - Intervalles pas Ã  pas</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@600;700;800&family=Nunito:wght@500;700;800&display=swap" rel="stylesheet" />
  <style>
    :root {
      --bg1: #fff4e8;
      --bg2: #dbf4ff;
      --ink: #1a2a3f;
      --card: #ffffff;
      --orange: #ff8a3d;
      --blue: #27b5ff;
      --green: #13a76a;
      --red: #d84f4f;
      --shadow: 0 14px 28px rgba(26, 42, 63, 0.14);
      --r: 18px;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      color: var(--ink);
      font-family: "Nunito", sans-serif;
      background:
        radial-gradient(circle at 12% 12%, rgba(255, 138, 61, 0.35), transparent 35%),
        radial-gradient(circle at 85% 8%, rgba(39, 181, 255, 0.35), transparent 36%),
        linear-gradient(140deg, var(--bg1), var(--bg2));
      min-height: 100vh;
    }

    main {
      max-width: 960px;
      margin: 0 auto;
      padding: 18px 14px 32px;
    }

    .top {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: space-between;
      align-items: center;
    }

    .back {
      text-decoration: none;
      color: #0f6fd2;
      font-weight: 800;
      background: #ffffffaa;
      padding: 8px 12px;
      border-radius: 999px;
    }

    .pill {
      background: linear-gradient(120deg, var(--orange), #ffa55f);
      color: #fff;
      border-radius: 999px;
      padding: 8px 12px;
      font-weight: 800;
      font-size: 0.9rem;
    }

    h1 {
      font-family: "Baloo 2", cursive;
      font-size: clamp(2rem, 6vw, 3rem);
      margin: 12px 0 6px;
      line-height: 1;
    }

    .subtitle {
      margin: 0 0 12px;
      font-weight: 700;
      line-height: 1.45;
      font-size: 1.03rem;
    }

    .card {
      background: var(--card);
      border-radius: var(--r);
      box-shadow: var(--shadow);
      padding: 14px;
      margin-top: 12px;
    }

    .links-manager {
      margin-top: 12px;
      background: var(--card);
      border-radius: var(--r);
      box-shadow: var(--shadow);
      padding: 14px;
    }

    .links-manager h2 {
      margin: 0 0 6px;
      font-family: "Baloo 2", cursive;
      font-size: 1.2rem;
    }

    .links-manager p {
      margin: 0 0 10px;
      font-weight: 700;
    }

    .link-grid {
      display: grid;
      gap: 8px;
    }

    .link-item {
      display: grid;
      gap: 6px;
    }

    .link-item label {
      font-size: 0.9rem;
      font-weight: 800;
    }

    .links-actions {
      margin-top: 10px;
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    #saveLinks { background: linear-gradient(120deg, #2ebd88, #73d8b3); color: #053b27; }
    #resetLinks { background: linear-gradient(120deg, #ffd49f, #ffeaad); color: #5e4000; }

    .links-list {
      margin-top: 10px;
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .links-list a {
      text-decoration: none;
      font-weight: 800;
      color: #0f6fd2;
      border: 2px solid #d6e5f5;
      border-radius: 10px;
      padding: 8px 10px;
      background: #fff;
    }

    #linksStatus {
      margin-top: 8px;
      font-size: 0.88rem;
      font-weight: 800;
    }

    .small { font-size: 0.95rem; line-height: 1.45; }

    .example {
      background: #f8fbff;
      border-left: 5px solid var(--blue);
      border-radius: 12px;
      padding: 10px;
      margin-top: 8px;
      font-weight: 700;
    }

    #exercise-box h2 {
      margin: 2px 0 6px;
      font-size: 1.18rem;
      font-family: "Baloo 2", cursive;
    }

    #q-text {
      margin: 8px 0;
      font-size: 1.06rem;
      font-weight: 800;
      line-height: 1.45;
    }

    .choices {
      display: grid;
      gap: 8px;
      margin-top: 8px;
    }

    .choice {
      display: flex;
      gap: 8px;
      align-items: flex-start;
      border-radius: 12px;
      background: #f7fbff;
      padding: 9px 10px;
      border: 2px solid #d9ebfa;
    }

    input[type="text"] {
      width: 100%;
      padding: 11px;
      border: 2px solid #d7e7f5;
      border-radius: 12px;
      font-size: 1rem;
      font-family: "Nunito", sans-serif;
      margin-top: 8px;
    }

    .row {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-top: 10px;
    }

    button {
      border: 0;
      border-radius: 12px;
      padding: 10px 12px;
      font-family: "Nunito", sans-serif;
      font-weight: 800;
      cursor: pointer;
    }

    #check { background: linear-gradient(120deg, var(--orange), #ff9c58); color: #fff; }
    #next { background: linear-gradient(120deg, var(--blue), #7ad4ff); color: #00334d; }
    #pause { background: linear-gradient(120deg, #bcead8, #86d9bb); color: #084b35; }

    #feedback { margin-top: 10px; font-weight: 800; line-height: 1.45; }
    #feedback.ok { color: var(--green); }
    #feedback.bad { color: var(--red); }

    .progress {
      margin-top: 10px;
      background: #e6f3fb;
      border-radius: 999px;
      height: 10px;
      overflow: hidden;
    }

    .bar {
      height: 100%;
      width: 0;
      background: linear-gradient(120deg, var(--orange), var(--blue));
      transition: width 0.3s ease;
    }

    .stat {
      margin-top: 7px;
      font-weight: 800;
      font-size: 0.95rem;
    }

    .pause-box {
      display: none;
      margin-top: 10px;
      padding: 10px;
      border-radius: 12px;
      background: #fff7e9;
      border: 2px dashed #ffc288;
      font-weight: 800;
    }

    @media (max-width: 640px) {
      #q-text { font-size: 1rem; }
      .subtitle { font-size: 0.98rem; }
    }
  </style>
</head>
<body>
  <main>
    <div class="top">
      <a class="back" href="index.html">Retour au menu</a>
      <span class="pill">Niveau 1 - Intervalles</span>
    </div>

    <h1>Intervalles en douceur</h1>
    <p class="subtitle">
      On avance trÃ¨s progressivement. Objectif: comprendre <strong>[a;b[</strong>,
      <strong>l'intersection (âˆ©)</strong> et <strong>la rÃ©union (âˆª)</strong> avec des exemples concrets.
    </p>

    <section class="links-manager">
      <h2>Liens HTML rapides (Maths)</h2>
      <p>Colle tes liens puis clique "Enregistrer".</p>
      <div class="link-grid">
        <div class="link-item">
          <label for="mathLink1">ðŸ”— Lien 1</label>
          <input id="mathLink1" type="text" placeholder="ex: devoirs/maths_exercice1.html" />
        </div>
        <div class="link-item">
          <label for="mathLink2">ðŸ”— Lien 2</label>
          <input id="mathLink2" type="text" placeholder="ex: devoirs/maths_exercice2.html" />
        </div>
        <div class="link-item">
          <label for="mathLink3">ðŸ”— Lien 3</label>
          <input id="mathLink3" type="text" placeholder="ex: devoirs/maths_exercice3.html" />
        </div>
      </div>
      <div class="links-actions">
        <button id="saveLinks" type="button">Enregistrer les liens</button>
        <button id="resetLinks" type="button">Reinitialiser</button>
      </div>
      <div id="mathLinksList" class="links-list"></div>
      <div id="linksStatus"></div>
    </section>

    <section class="card small">
      <strong>Image concrÃ¨te:</strong> pense Ã  une rue avec des maisons numÃ©rotÃ©es.
      Un intervalle, c'est une zone de maisons autorisÃ©es.
      <div class="example">Exemple: [2;6[ = on prend 2, 3, 4, 5 et tout ce qu'il y a entre, mais pas 6.</div>
      <div class="example">Intersection (âˆ©): ce que deux zones ont en commun.</div>
      <div class="example">RÃ©union (âˆª): tout ce qu'on a dans la zone 1 ou la zone 2.</div>
    </section>

    <section id="exercise-box" class="card">
      <h2 id="q-title">Exercice</h2>
      <p id="q-text"></p>
      <div id="q-area"></div>
      <div class="row">
        <button id="check">Valider</button>
        <button id="next" disabled>Suivant</button>
        <button id="pause">Pause</button>
      </div>
      <p id="feedback"></p>
      <div class="progress"><div id="bar" class="bar"></div></div>
      <p id="stat" class="stat"></p>
      <div id="pauseBox" class="pause-box"></div>
    </section>
  </main>

  <script>
    const exercices = [
      {
        type: "qcm",
        titre: "1/14 - Lire un intervalle",
        question: "Dans [3;8[, le nombre 3 est-il inclus ?",
        choix: ["Oui", "Non"],
        reponse: 0,
        explication: "Le crochet fermÃ© [ signifie: on prend le nombre."
      },
      {
        type: "qcm",
        titre: "2/14 - Lire un intervalle",
        question: "Dans [3;8[, le nombre 8 est-il inclus ?",
        choix: ["Oui", "Non"],
        reponse: 1,
        explication: "Le crochet ouvert [ Ã  droite signifie: on ne prend pas 8."
      },
      {
        type: "text",
        titre: "3/14 - Notation",
        question: "Ã‰cris l'intervalle 'de 0 inclus Ã  5 exclu'.",
        attendus: ["[0;5["],
        explication: "Inclus Ã  gauche = [, exclu Ã  droite = [."
      },
      {
        type: "qcm",
        titre: "4/14 - Appartenance",
        question: "Le nombre 4 appartient-il Ã  [1;4[ ?",
        choix: ["Oui", "Non"],
        reponse: 1,
        explication: "4 est la borne de droite et elle est exclue."
      },
      {
        type: "qcm",
        titre: "5/14 - Intersection",
        question: "A=[1;6] et B=[4;9]. Quel est A âˆ© B ?",
        choix: ["[1;9]", "[4;6]", "[1;4]"],
        reponse: 1,
        explication: "Intersection = partie commune."
      },
      {
        type: "text",
        titre: "6/14 - Intersection",
        question: "A=[-2;3] et B=[1;5]. Ã‰cris A âˆ© B.",
        attendus: ["[1;3]"],
        explication: "On garde ce qui est dans les deux: de 1 Ã  3."
      },
      {
        type: "qcm",
        titre: "7/14 - RÃ©union",
        question: "A=[1;4] et B=[3;7]. Quel est A âˆª B ?",
        choix: ["[3;4]", "[1;7]", "[1;3]"],
        reponse: 1,
        explication: "RÃ©union = tout ce qu'on couvre avec A ou B."
      },
      {
        type: "text",
        titre: "8/14 - RÃ©union",
        question: "A=[-1;2[ et B=[2;5]. Ã‰cris A âˆª B.",
        attendus: ["[-1;5]"],
        explication: "2 est pris par B, donc pas de trou: on va de -1 Ã  5."
      },
      {
        type: "qcm",
        titre: "9/14 - Cas sans recouvrement",
        question: "A=[0;2] et B=[5;7]. L'intersection vaut...",
        choix: ["[2;5]", "âˆ…", "[0;7]"],
        reponse: 1,
        explication: "Pas de partie commune, donc ensemble vide."
      },
      {
        type: "text",
        titre: "10/14 - Cas sans recouvrement",
        question: "A=[0;2] et B=[5;7]. Ã‰cris A âˆª B.",
        attendus: ["[0;2]âˆª[5;7]", "[0;2] u [5;7]", "[0;2]u[5;7]"],
        explication: "Les deux intervalles restent sÃ©parÃ©s."
      },
      {
        type: "qcm",
        titre: "11/14 - Vie rÃ©elle",
        question: "CinÃ©ma: tarif enfant pour Ã¢ge x dans [6;12[. Un enfant de 12 ans paie ce tarif ?",
        choix: ["Oui", "Non"],
        reponse: 1,
        explication: "12 est exclu, donc non."
      },
      {
        type: "text",
        titre: "12/14 - Vie rÃ©elle",
        question: "Piscine: bassin junior autorisÃ© pour x dans [8;14]. Un enfant de 8 ans est autorisÃ© ? (rÃ©ponds oui/non)",
        attendus: ["oui"],
        explication: "8 est inclus grÃ¢ce au crochet fermÃ© [."
      },
      {
        type: "qcm",
        titre: "13/14 - SynthÃ¨se",
        question: "A=[-3;1] et B=[1;6]. A âˆ© B vaut...",
        choix: ["{1}", "[-3;6]", "âˆ…"],
        reponse: 0,
        explication: "Le seul point commun est 1."
      },
      {
        type: "text",
        titre: "14/14 - SynthÃ¨se",
        question: "A=[-3;1] et B=[1;6]. Ã‰cris A âˆª B.",
        attendus: ["[-3;6]"],
        explication: "Les intervalles se touchent en 1 (inclus), donc tout fusionne."
      }
    ];

    const qTitle = document.getElementById("q-title");
    const qText = document.getElementById("q-text");
    const qArea = document.getElementById("q-area");
    const feedback = document.getElementById("feedback");
    const checkBtn = document.getElementById("check");
    const nextBtn = document.getElementById("next");
    const pauseBtn = document.getElementById("pause");
    const bar = document.getElementById("bar");
    const stat = document.getElementById("stat");
    const pauseBox = document.getElementById("pauseBox");

    let i = 0;
    let score = 0;
    let validated = false;

    function norm(v) {
      return (v || "")
        .toLowerCase()
        .trim()
        .normalize("NFD")
        .replace(/[\u0300-\u036f]/g, "")
        .replace(/\s+/g, " ")
        .replace(/\s*;\s*/g, ";")
        .replace(/\s*\[\s*/g, "[")
        .replace(/\s*\]\s*/g, "]")
        .replace(/\s*âˆª\s*/g, "âˆª")
        .replace(/\s*u\s*/g, "u");
    }

    function encouragement() {
      const pool = [
        "TrÃ¨s bien, tu avances super.",
        "Bravo, continue comme Ã§a.",
        "Excellent effort, on progresse.",
        "Top, tu as compris cette Ã©tape."
      ];
      return pool[Math.floor(Math.random() * pool.length)];
    }

    function render() {
      const ex = exercices[i];
      validated = false;
      qTitle.textContent = ex.titre;
      qText.textContent = ex.question;
      feedback.textContent = "";
      feedback.className = "";
      nextBtn.disabled = true;
      pauseBox.style.display = "none";
      pauseBox.textContent = "";

      if (ex.type === "qcm") {
        qArea.innerHTML = `<div class="choices">${ex.choix.map((c, idx) => `
          <label class="choice"><input type="radio" name="rep" value="${idx}" /> <span>${c}</span></label>
        `).join("")}</div>`;
      } else {
        qArea.innerHTML = `<input id="repText" type="text" placeholder="Ã‰cris ta rÃ©ponse" />`;
      }

      bar.style.width = `${(i / exercices.length) * 100}%`;
      stat.textContent = `Question ${i + 1}/${exercices.length} - Score ${score}`;
    }

    function check() {
      if (validated) return;
      const ex = exercices[i];
      let ok = false;

      if (ex.type === "qcm") {
        const sel = document.querySelector('input[name="rep"]:checked');
        if (!sel) {
          feedback.textContent = "Choisis une rÃ©ponse, puis valide.";
          feedback.className = "bad";
          return;
        }
        ok = Number(sel.value) === ex.reponse;
      } else {
        const value = norm(document.getElementById("repText").value);
        ok = ex.attendus.some(a => value === norm(a));
      }

      validated = true;
      nextBtn.disabled = false;

      if (ok) {
        score += 1;
        feedback.textContent = `${encouragement()} ${ex.explication}`;
        feedback.className = "ok";
      } else {
        feedback.textContent = `On reprend calmement: ${ex.explication}`;
        feedback.className = "bad";
      }

      stat.textContent = `Question ${i + 1}/${exercices.length} - Score ${score}`;

      if ((i + 1) % 4 === 0 && i + 1 < exercices.length) {
        pauseBox.style.display = "block";
        pauseBox.textContent = "Pause conseillÃ©e: respire 20 secondes. Clique 'Suivant' quand tu es prÃªte.";
      }
    }

    function next() {
      if (!validated) return;
      i += 1;
      if (i >= exercices.length) {
        qTitle.textContent = "TerminÃ©";
        qText.textContent = "Tu viens de finir ce niveau sur les intervalles. TrÃ¨s bon travail.";
        qArea.innerHTML = `<div class="example">RÃ©sultat final: ${score}/${exercices.length}. Tu peux refaire pour progresser encore.</div>`;
        feedback.textContent = "";
        nextBtn.disabled = true;
        checkBtn.disabled = true;
        pauseBtn.disabled = true;
        bar.style.width = "100%";
        stat.textContent = `Score final: ${score}/${exercices.length}`;
        return;
      }
      render();
    }

    pauseBtn.addEventListener("click", () => {
      pauseBox.style.display = "block";
      pauseBox.textContent = "Pause activÃ©e. Bois un verre d'eau, dÃ©tends-toi, puis reprends quand tu veux.";
    });

    checkBtn.addEventListener("click", check);
    nextBtn.addEventListener("click", next);

    function renderMathLinks(values) {
      const list = document.getElementById("mathLinksList");
      const status = document.getElementById("linksStatus");
      const labels = [
        { id: "link1", label: "ðŸ”— Lien 1" },
        { id: "link2", label: "ðŸ”— Lien 2" },
        { id: "link3", label: "ðŸ”— Lien 3" }
      ];
      const entries = labels
        .map((item) => ({ ...item, href: values[item.id] || "" }))
        .filter((item) => item.href);

      if (!entries.length) {
        list.innerHTML = "";
        status.textContent = "Aucun lien enregistre pour le moment.";
        return;
      }

      list.innerHTML = entries
        .map((item) => `<a href="${item.href}">${item.label}</a>`)
        .join("");
      status.textContent = `${entries.length} lien(s) pret(s).`;
    }

    function initMathLinks() {
      const key = "classe_seconde_links_maths";
      let data = { link1: "", link2: "", link3: "" };
      try {
        const raw = localStorage.getItem(key);
        if (raw) {
          const parsed = JSON.parse(raw);
          if (parsed && typeof parsed === "object") {
            data = { ...data, ...parsed };
          }
        }
      } catch (_) {}

      document.getElementById("mathLink1").value = data.link1 || "";
      document.getElementById("mathLink2").value = data.link2 || "";
      document.getElementById("mathLink3").value = data.link3 || "";
      renderMathLinks(data);

      document.getElementById("saveLinks").addEventListener("click", () => {
        const nextData = {
          link1: document.getElementById("mathLink1").value.trim(),
          link2: document.getElementById("mathLink2").value.trim(),
          link3: document.getElementById("mathLink3").value.trim()
        };
        localStorage.setItem(key, JSON.stringify(nextData));
        renderMathLinks(nextData);
        document.getElementById("linksStatus").textContent = "Liens enregistres.";
      });

      document.getElementById("resetLinks").addEventListener("click", () => {
        localStorage.removeItem(key);
        document.getElementById("mathLink1").value = "";
        document.getElementById("mathLink2").value = "";
        document.getElementById("mathLink3").value = "";
        renderMathLinks({ link1: "", link2: "", link3: "" });
        document.getElementById("linksStatus").textContent = "Liens reinitialises.";
      });
    }

    initMathLinks();
    render();
  </script>
</body>
</html>
